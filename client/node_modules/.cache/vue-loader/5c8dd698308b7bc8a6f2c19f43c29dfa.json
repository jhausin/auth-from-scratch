{"remainingRequest":"/Users/jannik/dev/auth-from-scratch/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jannik/dev/auth-from-scratch/client/src/views/SignUp.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jannik/dev/auth-from-scratch/client/src/views/SignUp.vue","mtime":1600500894616},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBKb2kgZnJvbSAiam9pIjsKaW1wb3J0IExvYWRpbmcgZnJvbSAiLi4vYXNzZXRzL2xvYWRpbmctbG9vcC5zdmciOwoKY29uc3QgU0lHTlVQX1VSTCA9ICJodHRwOi8vbG9jYWxob3N0OjUwMDAvYXV0aC9zaWdudXAiOwoKY29uc3Qgc2NoZW1hID0gSm9pLm9iamVjdCgpLmtleXMoewogICAgdXNlcm5hbWU6IEpvaS5zdHJpbmcoKQogICAgICAgIC5yZWdleCgvKF5bYS16QS1aMC05X10rJCkvKQogICAgICAgIC5taW4oMikKICAgICAgICAubWF4KDMwKQogICAgICAgIC5yZXF1aXJlZCgpLAogICAgcGFzc3dvcmQ6IEpvaS5zdHJpbmcoKQogICAgICAgIC50cmltKCkKICAgICAgICAubWluKDgpCiAgICAgICAgLnJlcXVpcmVkKCksCiAgICBjb25maXJtUGFzc3dvcmQ6IEpvaS5zdHJpbmcoKQogICAgICAgIC50cmltKCkKICAgICAgICAubWluKDgpCiAgICAgICAgLnJlcXVpcmVkKCksCn0pOwpleHBvcnQgZGVmYXVsdCB7CiAgICBkYXRhOiAoKSA9PiAoewogICAgICAgIHNpZ25pbmdVcDogZmFsc2UsCiAgICAgICAgZXJyb3JNZXNzYWdlOiAiIiwKICAgICAgICB1c2VyOiB7CiAgICAgICAgICAgIHVzZXJuYW1lOiAiIiwKICAgICAgICAgICAgcGFzc3dvcmQ6ICIiLAogICAgICAgICAgICBjb25maXJtUGFzc3dvcmQ6ICIiLAogICAgICAgIH0sCiAgICB9KSwKICAgIHdhdGNoOiB7CiAgICAgICAgdXNlcjogewogICAgICAgICAgICBoYW5kbGVyKCkgewogICAgICAgICAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAiIjsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZGVlcDogdHJ1ZSwKICAgICAgICB9LAogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBzaWdudXAoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkVXNlcigpKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiVXNlciBpcyB2YWxpZC4gc2VuZGluZyBkYXRhIHRvIHNlcnZlci4uLiIpOwogICAgICAgICAgICAgICAgY29uc3QgYm9keSA9IHsKICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VyLnVzZXJuYW1lLAogICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLnVzZXIucGFzc3dvcmQsCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgdGhpcy5zaWduaW5nVXAgPSB0cnVlOwogICAgICAgICAgICAgICAgLy9pZiB2YWxpZCA9PiBzZW5kIHRvIHNlcnZlcgogICAgICAgICAgICAgICAgZmV0Y2goU0lHTlVQX1VSTCwgewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy9pZiByZXNwb25zZSBvayA9PiB1c2VyIHNpZ25lZCB1cAogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy9vdGhlcndpc2UgdGhlcmUgd2FzIGFuIGVycm9yID0+IHRocm93IG5ldyBFcnJvciA9PiBoYW5kbGUgaXQKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKS50aGVuKChlcnJvcikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXN1bHQpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInRva2VuIiwgcmVzdWx0LnRva2VuKTsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNpZ25pbmdVcCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9kYXNoYm9hcmQiKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaWduaW5nVXAgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZTsKICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHZhbGlkVXNlcigpIHsKICAgICAgICAgICAgaWYgKHRoaXMudXNlci5wYXNzd29yZCAhPT0gdGhpcy51c2VyLmNvbmZpcm1QYXNzd29yZCkgewogICAgICAgICAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAiUGFzc3dvcmQgbXVzdCBtYXRjaC4iOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHsgdmFsdWUsIGVycm9yIH0gPSBzY2hlbWEudmFsaWRhdGUodGhpcy51c2VyKTsKCiAgICAgICAgICAgIGlmIChlcnJvciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygidXNlcm5hbWUiKSkgewogICAgICAgICAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAiSW52YWxpZCBVc2VybmFtZS4iOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAiSW52YWxpZCBQYXNzd29yZC4iOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9LAogICAgfSwKfTsK"},{"version":3,"sources":["SignUp.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SignUp.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <section>\n        <h1>Sign Up</h1>\n        <div v-if=\"signingUp\">\n            <img src=\"../assets/loading-loop.svg\" />\n        </div>\n        <div v-if=\"errorMessage\" class=\"alert alert-danger\" role=\"alert\">\n            {{ errorMessage }}\n        </div>\n        <form v-if=\"!signingUp\" @submit.prevent=\"signup\">\n            <div class=\"form-group\">\n                <label for=\"username\">Username</label>\n                <input\n                    v-model=\"user.username\"\n                    type=\"text\"\n                    class=\"form-control\"\n                    id=\"username\"\n                    placeholder=\"Enter Username\"\n                    aria-describedby=\"usernameHelp\"\n                    required\n                />\n                <small id=\"usernameHelp\" class=\"form-text text-muted\">\n                    Username must be longer than 2 characters and shorter than\n                    30.\n                    <br />Username can only contain alphanumeric characters and\n                    underscores.\n                </small>\n            </div>\n            <div class=\"form-row\">\n                <div class=\"form-group col-md-6\">\n                    <label for=\"password\">Password</label>\n                    <input\n                        v-model=\"user.password\"\n                        type=\"password\"\n                        class=\"form-control\"\n                        id=\"password\"\n                        placeholder=\"Password\"\n                        required\n                    />\n                    <small id=\"passwordHelp\" class=\"form-text text-muted\"\n                        >Password must be at least 8 characters long.</small\n                    >\n                </div>\n                <div class=\"form-group col-md-6\">\n                    <label for=\"confirmPassword\">Confirm Password</label>\n                    <input\n                        v-model=\"user.confirmPassword\"\n                        type=\"password\"\n                        class=\"form-control\"\n                        id=\"confirmPassword\"\n                        placeholder=\"Confirm Password\"\n                        required\n                    />\n                    <small id=\"confirmPasswordHelp\" class=\"form-text text-muted\"\n                        >Please confirm password.</small\n                    >\n                </div>\n            </div>\n            <button type=\"submit\" class=\"btn btn-primary\">Submit</button>\n        </form>\n    </section>\n</template>\n\n<script>\nimport Joi from \"joi\";\nimport Loading from \"../assets/loading-loop.svg\";\n\nconst SIGNUP_URL = \"http://localhost:5000/auth/signup\";\n\nconst schema = Joi.object().keys({\n    username: Joi.string()\n        .regex(/(^[a-zA-Z0-9_]+$)/)\n        .min(2)\n        .max(30)\n        .required(),\n    password: Joi.string()\n        .trim()\n        .min(8)\n        .required(),\n    confirmPassword: Joi.string()\n        .trim()\n        .min(8)\n        .required(),\n});\nexport default {\n    data: () => ({\n        signingUp: false,\n        errorMessage: \"\",\n        user: {\n            username: \"\",\n            password: \"\",\n            confirmPassword: \"\",\n        },\n    }),\n    watch: {\n        user: {\n            handler() {\n                this.errorMessage = \"\";\n            },\n            deep: true,\n        },\n    },\n    methods: {\n        signup() {\n            if (this.validUser()) {\n                console.log(\"User is valid. sending data to server...\");\n                const body = {\n                    username: this.user.username,\n                    password: this.user.password,\n                };\n                this.signingUp = true;\n                //if valid => send to server\n                fetch(SIGNUP_URL, {\n                    method: \"POST\",\n                    body: JSON.stringify(body),\n                    headers: {\n                        \"content-type\": \"application/json\",\n                    },\n                })\n                    .then((response) => {\n                        //if response ok => user signed up\n                        if (response.ok) {\n                            return response.json();\n                        }\n                        //otherwise there was an error => throw new Error => handle it\n                        return response.json().then((error) => {\n                            throw new Error(error.message);\n                        });\n                    })\n                    .then((result) => {\n                        localStorage.setItem(\"token\", result.token);\n                        setTimeout(() => {\n                            this.signingUp = false;\n                            this.$router.push(\"/dashboard\");\n                        }, 1000);\n                    })\n                    .catch((error) => {\n                        setTimeout(() => {\n                            this.signingUp = false;\n                            this.errorMessage = error.message;\n                        }, 1000);\n                    });\n            }\n        },\n        validUser() {\n            if (this.user.password !== this.user.confirmPassword) {\n                this.errorMessage = \"Password must match.\";\n            }\n            const { value, error } = schema.validate(this.user);\n\n            if (error === undefined) {\n                return true;\n            }\n            if (error.message.includes(\"username\")) {\n                this.errorMessage = \"Invalid Username.\";\n            } else {\n                this.errorMessage = \"Invalid Password.\";\n            }\n            return false;\n        },\n    },\n};\n</script>\n<style></style>\n"]}]}