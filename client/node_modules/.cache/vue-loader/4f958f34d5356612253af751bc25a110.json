{"remainingRequest":"/Users/jannik/dev/auth-from-scratch/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jannik/dev/auth-from-scratch/client/src/views/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jannik/dev/auth-from-scratch/client/src/views/Login.vue","mtime":1600265157633},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBKb2kgZnJvbSAiam9pIjsKCmNvbnN0IExPR0lOX1VSTCA9ICJodHRwOi8vbG9jYWxob3N0OjUwMDAvYXV0aC9sb2dpbiI7Cgpjb25zdCBzY2hlbWEgPSBKb2kub2JqZWN0KCkua2V5cyh7CiAgdXNlcm5hbWU6IEpvaS5zdHJpbmcoKQogICAgLnJlZ2V4KC8oXlthLXpBLVowLTlfXSskKS8pCiAgICAubWluKDIpCiAgICAubWF4KDMwKQogICAgLnJlcXVpcmVkKCksCiAgcGFzc3dvcmQ6IEpvaS5zdHJpbmcoKQogICAgLnRyaW0oKQogICAgLm1pbig4KQogICAgLnJlcXVpcmVkKCksCn0pOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogKCkgPT4gKHsKICAgIGVycm9yTWVzc2FnZTogIiIsCiAgICB1c2VyOiB7CiAgICAgIHVzZXJuYW1lOiAiIiwKICAgICAgcGFzc3dvcmQ6ICIiLAogICAgfSwKICB9KSwKICB3YXRjaDogewogICAgdXNlcjogewogICAgICBoYW5kbGVyKCkgewogICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gIiI7CiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUsCiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgbG9naW4oKSB7CiAgICAgIGlmICh0aGlzLnZhbGlkVXNlcigpKSB7CiAgICAgICAgY29uc29sZS5sb2coImxvZ2dpbmcgaW4uLi4iKTsKICAgICAgICBjb25zdCBib2R5ID0gewogICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlci51c2VybmFtZSwKICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLnVzZXIucGFzc3dvcmQsCiAgICAgICAgfTsKICAgICAgICBmZXRjaChMT0dJTl9VUkwsIHsKICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksCiAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICB9LAogICAgICAgIH0pCiAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpLnRoZW4oKGVycm9yKSA9PiB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yLm1lc3NhZ2UpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pCiAgICAgICAgICAudGhlbigocmVzdWx0KSA9PiB7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ0b2tlbiIsIHJlc3VsdC50b2tlbik7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvZGFzaGJvYXJkIik7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGVycm9yOwogICAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICB2YWxpZFVzZXIoKSB7CiAgICAgIGNvbnN0IHsgdmFsdWUsIGVycm9yIH0gPSBzY2hlbWEudmFsaWRhdGUodGhpcy51c2VyKTsKICAgICAgaWYgKGVycm9yID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICB0aGlzLmVycm9yTWVzc2FnZSA9ICJJbnZhbGlkIFVzZXJuYW1lIG9yIFBhc3N3b3JkLiI7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <section>\n    <h1>Login</h1>\n    <div v-if=\"errorMessage\" class=\"alert alert-danger\" role=\"alert\">\n      {{ errorMessage }}\n    </div>\n    <form @submit.prevent=\"login()\">\n      <div class=\"form-group\">\n        <label for=\"username\">Username:</label>\n        <input\n          v-model=\"user.username\"\n          type=\"text\"\n          class=\"form-control\"\n          id=\"username\"\n          placeholder=\"Enter Username\"\n          aria-describedby=\"usernameHelp\"\n          required\n        />\n        <small id=\"usernameHelp\" class=\"form-text text-muted\">\n          Enter Username to login.\n        </small>\n      </div>\n      <div class=\"form-group\">\n        <label for=\"password\">Password:</label>\n        <input\n          v-model=\"user.password\"\n          type=\"password\"\n          class=\"form-control\"\n          id=\"password\"\n          placeholder=\"Enter Password\"\n          aria-describedby=\"passwordHelp\"\n          required\n        />\n        <small id=\"passwordHelp\" class=\"form-text text-muted\">\n          Enter Password.\n        </small>\n      </div>\n      <button type=\"submit\" class=\"btn btn-primary\">Login</button>\n    </form>\n  </section>\n</template>\n\n<script>\nimport Joi from \"joi\";\n\nconst LOGIN_URL = \"http://localhost:5000/auth/login\";\n\nconst schema = Joi.object().keys({\n  username: Joi.string()\n    .regex(/(^[a-zA-Z0-9_]+$)/)\n    .min(2)\n    .max(30)\n    .required(),\n  password: Joi.string()\n    .trim()\n    .min(8)\n    .required(),\n});\nexport default {\n  data: () => ({\n    errorMessage: \"\",\n    user: {\n      username: \"\",\n      password: \"\",\n    },\n  }),\n  watch: {\n    user: {\n      handler() {\n        this.errorMessage = \"\";\n      },\n      deep: true,\n    },\n  },\n  methods: {\n    login() {\n      if (this.validUser()) {\n        console.log(\"logging in...\");\n        const body = {\n          username: this.user.username,\n          password: this.user.password,\n        };\n        fetch(LOGIN_URL, {\n          method: \"POST\",\n          body: JSON.stringify(body),\n          headers: {\n            \"content-type\": \"application/json\",\n          },\n        })\n          .then((response) => {\n            if (response.ok) {\n              return response.json();\n            }\n            return response.json().then((error) => {\n              throw new Error(error.message);\n            });\n          })\n          .then((result) => {\n            localStorage.setItem(\"token\", result.token);\n            this.$router.push(\"/dashboard\");\n          })\n          .catch((error) => {\n            this.errorMessage = error;\n          });\n      }\n    },\n    validUser() {\n      const { value, error } = schema.validate(this.user);\n      if (error === undefined) {\n        return true;\n      }\n      this.errorMessage = \"Invalid Username or Password.\";\n      return false;\n    },\n  },\n};\n</script>\n\n<style></style>\n"]}]}