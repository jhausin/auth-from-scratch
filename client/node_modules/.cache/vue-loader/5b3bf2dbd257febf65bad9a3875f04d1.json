{"remainingRequest":"/Users/jannik/dev/auth-from-scratch/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jannik/dev/auth-from-scratch/client/src/views/SignUp.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jannik/dev/auth-from-scratch/client/src/views/SignUp.vue","mtime":1600180214707},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jannik/dev/auth-from-scratch/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBKb2kgZnJvbSAiam9pIjsKaW1wb3J0IExvYWRpbmcgZnJvbSAiLi4vYXNzZXRzL2xvYWRpbmctbG9vcC5zdmciOwoKY29uc3QgU0lHTlVQX1VSTCA9ICJodHRwOi8vbG9jYWxob3N0OjUwMDAvYXV0aC9zaWdudXAiOwoKY29uc3Qgc2NoZW1hID0gSm9pLm9iamVjdCgpLmtleXMoewogIHVzZXJuYW1lOiBKb2kuc3RyaW5nKCkKICAgIC5yZWdleCgvKF5bYS16QS1aMC05X10rJCkvKQogICAgLm1pbigyKQogICAgLm1heCgzMCkKICAgIC5yZXF1aXJlZCgpLAogIHBhc3N3b3JkOiBKb2kuc3RyaW5nKCkKICAgIC50cmltKCkKICAgIC5taW4oOCkKICAgIC5yZXF1aXJlZCgpLAogIGNvbmZpcm1QYXNzd29yZDogSm9pLnN0cmluZygpCiAgICAudHJpbSgpCiAgICAubWluKDgpCiAgICAucmVxdWlyZWQoKSwKfSk7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiAoKSA9PiAoewogICAgc2lnbmluZ1VwOiBmYWxzZSwKICAgIGVycm9yTWVzc2FnZTogIiIsCiAgICB1c2VyOiB7CiAgICAgIHVzZXJuYW1lOiAiIiwKICAgICAgcGFzc3dvcmQ6ICIiLAogICAgICBjb25maXJtUGFzc3dvcmQ6ICIiLAogICAgfSwKICB9KSwKICB3YXRjaDogewogICAgdXNlcjogewogICAgICBoYW5kbGVyKCkgewogICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gIiI7CiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUsCiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgc2lnbnVwKCkgewogICAgICBpZiAodGhpcy52YWxpZFVzZXIoKSkgewogICAgICAgIGNvbnNvbGUubG9nKCJVc2VyIGlzIHZhbGlkLiBzZW5kaW5nIGRhdGEgdG8gc2VydmVyLi4uIik7CiAgICAgICAgY29uc3QgYm9keSA9IHsKICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLnVzZXIudXNlcm5hbWUsCiAgICAgICAgICBwYXNzd29yZDogdGhpcy51c2VyLnBhc3N3b3JkLAogICAgICAgIH07CiAgICAgICAgdGhpcy5zaWduaW5nVXAgPSB0cnVlOwogICAgICAgIC8vaWYgdmFsaWQgPT4gc2VuZCB0byBzZXJ2ZXIKICAgICAgICBmZXRjaChTSUdOVVBfVVJMLCB7CiAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLAogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgfSwKICAgICAgICB9KQogICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgIC8vaWYgcmVzcG9uc2Ugb2sgPT4gdXNlciBzaWduZWQgdXAKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvL290aGVyd2lzZSB0aGVyZSB3YXMgYW4gZXJyb3IgPT4gdGhyb3cgbmV3IEVycm9yID0+IGhhbmRsZSBpdAogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpLnRoZW4oKGVycm9yKSA9PiB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yLm1lc3NhZ2UpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pCiAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgIHRoaXMuc2lnbmluZ1VwID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9sb2dpbiIpOwogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgIHRoaXMuc2lnbmluZ1VwID0gZmFsc2U7CiAgICAgICAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlOwogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgdmFsaWRVc2VyKCkgewogICAgICBpZiAodGhpcy51c2VyLnBhc3N3b3JkICE9PSB0aGlzLnVzZXIuY29uZmlybVBhc3N3b3JkKSB7CiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAiUGFzc3dvcmQgbXVzdCBtYXRjaC4iOwogICAgICB9CiAgICAgIGNvbnN0IHsgdmFsdWUsIGVycm9yIH0gPSBzY2hlbWEudmFsaWRhdGUodGhpcy51c2VyKTsKCiAgICAgIGlmIChlcnJvciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoInVzZXJuYW1lIikpIHsKICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9ICJJbnZhbGlkIFVzZXJuYW1lLiI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSAiSW52YWxpZCBQYXNzd29yZC4iOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["SignUp.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+DA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SignUp.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <section>\n    <h1>Sign Up</h1>\n    <div v-if=\"signingUp\">\n      <img src=\"../assets/loading-loop.svg\" />\n    </div>\n    <div v-if=\"errorMessage\" class=\"alert alert-danger\" role=\"alert\">\n      {{ errorMessage }}\n    </div>\n    <form v-if=\"!signingUp\" @submit.prevent=\"signup\">\n      <div class=\"form-group\">\n        <label for=\"username\">Username</label>\n        <input\n          v-model=\"user.username\"\n          type=\"text\"\n          class=\"form-control\"\n          id=\"username\"\n          placeholder=\"Enter Username\"\n          aria-describedby=\"usernameHelp\"\n          required\n        />\n        <small id=\"usernameHelp\" class=\"form-text text-muted\">\n          Username must be longer than 2 characters and shorter than 30.\n          <br />Username can only contain alphanumeric characters and\n          underscores.\n        </small>\n      </div>\n      <div class=\"form-row\">\n        <div class=\"form-group col-md-6\">\n          <label for=\"password\">Password</label>\n          <input\n            v-model=\"user.password\"\n            type=\"password\"\n            class=\"form-control\"\n            id=\"password\"\n            placeholder=\"Password\"\n            required\n          />\n          <small id=\"passwordHelp\" class=\"form-text text-muted\"\n            >Password must be at least 8 characters long.</small\n          >\n        </div>\n        <div class=\"form-group col-md-6\">\n          <label for=\"confirmPassword\">Confirm Password</label>\n          <input\n            v-model=\"user.confirmPassword\"\n            type=\"password\"\n            class=\"form-control\"\n            id=\"confirmPassword\"\n            placeholder=\"Confirm Password\"\n            required\n          />\n          <small id=\"confirmPasswordHelp\" class=\"form-text text-muted\"\n            >Please confirm password.</small\n          >\n        </div>\n      </div>\n      <button type=\"submit\" class=\"btn btn-primary\">Submit</button>\n    </form>\n  </section>\n</template>\n\n<script>\nimport Joi from \"joi\";\nimport Loading from \"../assets/loading-loop.svg\";\n\nconst SIGNUP_URL = \"http://localhost:5000/auth/signup\";\n\nconst schema = Joi.object().keys({\n  username: Joi.string()\n    .regex(/(^[a-zA-Z0-9_]+$)/)\n    .min(2)\n    .max(30)\n    .required(),\n  password: Joi.string()\n    .trim()\n    .min(8)\n    .required(),\n  confirmPassword: Joi.string()\n    .trim()\n    .min(8)\n    .required(),\n});\nexport default {\n  data: () => ({\n    signingUp: false,\n    errorMessage: \"\",\n    user: {\n      username: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n    },\n  }),\n  watch: {\n    user: {\n      handler() {\n        this.errorMessage = \"\";\n      },\n      deep: true,\n    },\n  },\n  methods: {\n    signup() {\n      if (this.validUser()) {\n        console.log(\"User is valid. sending data to server...\");\n        const body = {\n          username: this.user.username,\n          password: this.user.password,\n        };\n        this.signingUp = true;\n        //if valid => send to server\n        fetch(SIGNUP_URL, {\n          method: \"POST\",\n          body: JSON.stringify(body),\n          headers: {\n            \"content-type\": \"application/json\",\n          },\n        })\n          .then((response) => {\n            //if response ok => user signed up\n            if (response.ok) {\n              return response.json();\n            }\n            //otherwise there was an error => throw new Error => handle it\n            return response.json().then((error) => {\n              throw new Error(error.message);\n            });\n          })\n          .then(() => {\n            setTimeout(() => {\n              this.signingUp = false;\n              this.$router.push(\"/login\");\n            }, 1000);\n          })\n          .catch((error) => {\n            setTimeout(() => {\n              this.signingUp = false;\n              this.errorMessage = error.message;\n            }, 1000);\n          });\n      }\n    },\n    validUser() {\n      if (this.user.password !== this.user.confirmPassword) {\n        this.errorMessage = \"Password must match.\";\n      }\n      const { value, error } = schema.validate(this.user);\n\n      if (error === undefined) {\n        return true;\n      }\n      if (error.message.includes(\"username\")) {\n        this.errorMessage = \"Invalid Username.\";\n      } else {\n        this.errorMessage = \"Invalid Password.\";\n      }\n      return false;\n    },\n  },\n};\n</script>\n<style></style>\n"]}]}